# Copyright 2010 New Relic, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

import json
import re

from testing_support.mock_external_http_server import MockExternalHTTPServer

# This defines an external server test apps can make requests to instead of
# the real Bedrock backend. This provides 3 features:
#
# 1) This removes dependencies on external websites.
# 2) Provides a better mechanism for making an external call in a test app than
#    simple calling another endpoint the test app makes available because this
#    server will not be instrumented meaning we don't have to sort through
#    transactions to separate the ones created in the test app and the ones
#    created by an external call.
# 3) This app runs on a separate thread meaning it won't block the test app.

RESPONSES = {
    "ai21.j2-mid-v1::What is 212 degrees Fahrenheit converted to Celsius?": [
        {"Content-Type": "application/json", "x-amzn-RequestId": "c863d9fc-888b-421c-a175-ac5256baec62"},
        200,
        {
            "id": 1234,
            "prompt": {
                "text": "What is 212 degrees Fahrenheit converted to Celsius?",
                "tokens": [
                    {
                        "generatedToken": {
                            "token": "▁What▁is",
                            "logprob": -7.446773529052734,
                            "raw_logprob": -7.446773529052734,
                        },
                        "topTokens": None,
                        "textRange": {"start": 0, "end": 7},
                    },
                    {
                        "generatedToken": {
                            "token": "▁",
                            "logprob": -3.8046724796295166,
                            "raw_logprob": -3.8046724796295166,
                        },
                        "topTokens": None,
                        "textRange": {"start": 7, "end": 8},
                    },
                    {
                        "generatedToken": {
                            "token": "212",
                            "logprob": -9.287349700927734,
                            "raw_logprob": -9.287349700927734,
                        },
                        "topTokens": None,
                        "textRange": {"start": 8, "end": 11},
                    },
                    {
                        "generatedToken": {
                            "token": "▁degrees▁Fahrenheit",
                            "logprob": -7.953181743621826,
                            "raw_logprob": -7.953181743621826,
                        },
                        "topTokens": None,
                        "textRange": {"start": 11, "end": 30},
                    },
                    {
                        "generatedToken": {
                            "token": "▁converted▁to",
                            "logprob": -6.168096542358398,
                            "raw_logprob": -6.168096542358398,
                        },
                        "topTokens": None,
                        "textRange": {"start": 30, "end": 43},
                    },
                    {
                        "generatedToken": {
                            "token": "▁Celsius",
                            "logprob": -0.09790332615375519,
                            "raw_logprob": -0.09790332615375519,
                        },
                        "topTokens": None,
                        "textRange": {"start": 43, "end": 51},
                    },
                    {
                        "generatedToken": {
                            "token": "?",
                            "logprob": -6.5795369148254395,
                            "raw_logprob": -6.5795369148254395,
                        },
                        "topTokens": None,
                        "textRange": {"start": 51, "end": 52},
                    },
                ],
            },
            "completions": [
                {
                    "data": {
                        "text": "\n212 degrees Fahrenheit is equal to 100 degrees Celsius.",
                        "tokens": [
                            {
                                "generatedToken": {
                                    "token": "<|newline|>",
                                    "logprob": -1.6689286894688848e-06,
                                    "raw_logprob": -0.00015984688070602715,
                                },
                                "topTokens": None,
                                "textRange": {"start": 0, "end": 1},
                            },
                            {
                                "generatedToken": {
                                    "token": "▁",
                                    "logprob": -0.03473362699151039,
                                    "raw_logprob": -0.11261807382106781,
                                },
                                "topTokens": None,
                                "textRange": {"start": 1, "end": 1},
                            },
                            {
                                "generatedToken": {
                                    "token": "212",
                                    "logprob": -0.003316262038424611,
                                    "raw_logprob": -0.019686665385961533,
                                },
                                "topTokens": None,
                                "textRange": {"start": 1, "end": 4},
                            },
                            {
                                "generatedToken": {
                                    "token": "▁degrees▁Fahrenheit",
                                    "logprob": -0.003579758107662201,
                                    "raw_logprob": -0.03144374489784241,
                                },
                                "topTokens": None,
                                "textRange": {"start": 4, "end": 23},
                            },
                            {
                                "generatedToken": {
                                    "token": "▁is▁equal▁to",
                                    "logprob": -0.0027733694296330214,
                                    "raw_logprob": -0.027207009494304657,
                                },
                                "topTokens": None,
                                "textRange": {"start": 23, "end": 35},
                            },
                            {
                                "generatedToken": {
                                    "token": "▁",
                                    "logprob": -0.0003392120997887105,
                                    "raw_logprob": -0.005458095110952854,
                                },
                                "topTokens": None,
                                "textRange": {"start": 35, "end": 36},
                            },
                            {
                                "generatedToken": {
                                    "token": "100",
                                    "logprob": -2.145764938177308e-06,
                                    "raw_logprob": -0.00012730741582345217,
                                },
                                "topTokens": None,
                                "textRange": {"start": 36, "end": 39},
                            },
                            {
                                "generatedToken": {
                                    "token": "▁degrees▁Celsius",
                                    "logprob": -0.31207239627838135,
                                    "raw_logprob": -0.402545303106308,
                                },
                                "topTokens": None,
                                "textRange": {"start": 39, "end": 55},
                            },
                            {
                                "generatedToken": {
                                    "token": ".",
                                    "logprob": -0.023684674873948097,
                                    "raw_logprob": -0.0769972875714302,
                                },
                                "topTokens": None,
                                "textRange": {"start": 55, "end": 56},
                            },
                            {
                                "generatedToken": {
                                    "token": "<|endoftext|>",
                                    "logprob": -0.0073706600815057755,
                                    "raw_logprob": -0.06265579164028168,
                                },
                                "topTokens": None,
                                "textRange": {"start": 56, "end": 56},
                            },
                        ],
                    },
                    "finishReason": {"reason": "endoftext"},
                }
            ],
        },
    ],
    "amazon.titan-embed-g1-text-02::This is an embedding test.": [
        {"Content-Type": "application/json", "x-amzn-RequestId": "b10ac895-eae3-4f07-b926-10b2866c55ed"},
        200,
        {
            "embedding": [
                -0.14160156,
                0.034423828,
                0.54296875,
                0.10986328,
                0.053466797,
                0.3515625,
                0.12988281,
                -0.0002708435,
                -0.21484375,
                0.060302734,
                0.58984375,
                -0.5859375,
                0.52734375,
                0.82421875,
                -0.91015625,
                -0.19628906,
                0.45703125,
                0.609375,
                -0.67578125,
                0.39453125,
                -0.46875,
                -0.25390625,
                -0.21191406,
                0.114746094,
                0.31640625,
                -0.41015625,
                -0.32617188,
                -0.43554688,
                0.4765625,
                -0.4921875,
                0.40429688,
                0.06542969,
                0.859375,
                -0.008056641,
                -0.19921875,
                0.072753906,
                0.33203125,
                0.69921875,
                0.39453125,
                0.15527344,
                0.08886719,
                -0.25,
                0.859375,
                0.22949219,
                -0.19042969,
                0.13769531,
                -0.078125,
                0.41210938,
                0.875,
                0.5234375,
                0.59765625,
                -0.22949219,
                -0.22558594,
                -0.47460938,
                0.37695312,
                0.51953125,
                -0.5703125,
                0.46679688,
                0.43554688,
                0.17480469,
                -0.080566406,
                -0.16699219,
                -0.734375,
                -1.0625,
                -0.33984375,
                0.390625,
                -0.18847656,
                -0.5234375,
                -0.48828125,
                0.44921875,
                -0.09814453,
                -0.3359375,
                0.087402344,
                0.36914062,
                1.3203125,
                0.25585938,
                0.14746094,
                -0.059570312,
                -0.15820312,
                -0.037353516,
                -0.61328125,
                -0.6484375,
                -0.35351562,
                0.55078125,
                -0.26953125,
                0.90234375,
                0.3671875,
                0.31054688,
                0.00014019012,
                -0.171875,
                0.025512695,
                0.5078125,
                0.11621094,
                0.33203125,
                0.8125,
                -0.3046875,
                -1.078125,
                -0.5703125,
                0.26171875,
                -0.4609375,
                0.203125,
                0.44726562,
                -0.5078125,
                0.41601562,
                -0.1953125,
                0.028930664,
                -0.57421875,
                0.2265625,
                0.13574219,
                -0.040039062,
                -0.22949219,
                -0.515625,
                -0.19042969,
                -0.30078125,
                0.10058594,
                -0.66796875,
                0.6015625,
                0.296875,
                -0.765625,
                -0.87109375,
                0.2265625,
                0.068847656,
                -0.088378906,
                -0.1328125,
                -0.796875,
                -0.37304688,
                0.47460938,
                -0.3515625,
                -0.8125,
                -0.32226562,
                0.265625,
                0.3203125,
                -0.4140625,
                -0.49023438,
                0.859375,
                -0.19140625,
                -0.6328125,
                0.10546875,
                -0.5625,
                0.66015625,
                0.26171875,
                -0.2109375,
                0.421875,
                -0.82421875,
                0.29296875,
                0.17773438,
                0.24023438,
                0.5078125,
                -0.49804688,
                -0.10205078,
                0.10498047,
                -0.36132812,
                -0.47460938,
                -0.20996094,
                0.010070801,
                -0.546875,
                0.66796875,
                -0.123046875,
                -0.75390625,
                0.19628906,
                0.17480469,
                0.18261719,
                -0.96875,
                -0.26171875,
                0.4921875,
                -0.40039062,
                0.296875,
                0.1640625,
                -0.20507812,
                -0.36132812,
                0.76171875,
                -1.234375,
                -0.625,
                0.060058594,
                -0.09375,
                -0.14746094,
                1.09375,
                0.057861328,
                0.22460938,
                -0.703125,
                0.07470703,
                0.23828125,
                -0.083984375,
                -0.54296875,
                0.5546875,
                -0.5,
                -0.390625,
                0.106933594,
                0.6640625,
                0.27734375,
                -0.953125,
                0.35351562,
                -0.7734375,
                -0.77734375,
                0.16503906,
                -0.42382812,
                0.36914062,
                0.020141602,
                -1.3515625,
                0.18847656,
                0.13476562,
                -0.034179688,
                -0.03930664,
                -0.03857422,
                -0.027954102,
                0.73828125,
                -0.18945312,
                -0.09814453,
                -0.46289062,
                0.36914062,
                0.033203125,
                0.020874023,
                -0.703125,
                0.91796875,
                0.38671875,
                0.625,
                -0.19335938,
                -0.16796875,
                -0.58203125,
                0.21386719,
                -0.032470703,
                -0.296875,
                -0.15625,
                -0.1640625,
                -0.74609375,
                0.328125,
                0.5546875,
                -0.1953125,
                1.0546875,
                0.171875,
                -0.099609375,
                0.5234375,
                0.05078125,
                -0.35742188,
                -0.2734375,
                -1.3203125,
                -0.8515625,
                -0.16015625,
                0.01574707,
                0.29296875,
                0.18457031,
                -0.265625,
                0.048339844,
                0.045654297,
                -0.32226562,
                0.087890625,
                -0.0047302246,
                0.38671875,
                0.10644531,
                -0.06225586,
                1.03125,
                0.94140625,
                -0.3203125,
                0.20800781,
                -1.171875,
                0.48046875,
                -0.091796875,
                0.20800781,
                -0.1328125,
                -0.20507812,
                0.28125,
                -0.47070312,
                -0.09033203,
                0.0013809204,
                -0.08203125,
                0.43359375,
                -0.03100586,
                -0.060791016,
                -0.53515625,
                -1.46875,
                0.000101566315,
                0.515625,
                0.40625,
                -0.10498047,
                -0.15820312,
                -0.009460449,
                -0.77734375,
                -0.5859375,
                0.9765625,
                0.099609375,
                0.51953125,
                0.38085938,
                -0.09667969,
                -0.100097656,
                -0.5,
                -1.3125,
                -0.18066406,
                -0.099121094,
                0.26171875,
                -0.14453125,
                -0.546875,
                0.17578125,
                0.484375,
                0.765625,
                0.45703125,
                0.2734375,
                0.0028076172,
                0.17089844,
                -0.32421875,
                -0.37695312,
                0.30664062,
                -0.48046875,
                0.07128906,
                0.031982422,
                -0.31054688,
                -0.055419922,
                -0.29296875,
                0.3359375,
                -0.296875,
                0.47851562,
                -0.05126953,
                0.18457031,
                -0.01953125,
                -0.35742188,
                0.017944336,
                -0.25,
                0.10595703,
                0.17382812,
                -0.73828125,
                0.36914062,
                -0.15234375,
                -0.8125,
                0.17382812,
                0.048095703,
                0.5625,
                -0.33789062,
                0.023071289,
                -0.21972656,
                0.16015625,
                0.032958984,
                -1.1171875,
                -0.984375,
                0.83984375,
                0.009033203,
                -0.042236328,
                -0.46484375,
                -0.08203125,
                0.44726562,
                -0.765625,
                -0.3984375,
                -0.40820312,
                -0.234375,
                0.044189453,
                0.119628906,
                -0.7578125,
                -0.55078125,
                -0.4453125,
                0.7578125,
                0.34960938,
                0.96484375,
                0.35742188,
                0.36914062,
                -0.35351562,
                -0.36132812,
                1.109375,
                0.5859375,
                0.85546875,
                -0.10644531,
                -0.6953125,
                -0.0066833496,
                0.042236328,
                -0.06689453,
                0.36914062,
                0.9765625,
                -0.3046875,
                0.59765625,
                -0.6640625,
                0.21484375,
                -0.07128906,
                1.1328125,
                -0.51953125,
                0.86328125,
                -0.11328125,
                0.15722656,
                -0.36328125,
                -0.04638672,
                1.4375,
                0.18457031,
                -0.18359375,
                0.10595703,
                -0.49023438,
                -0.07324219,
                -0.73046875,
                -0.119140625,
                0.021118164,
                0.4921875,
                -0.46875,
                0.28710938,
                0.3359375,
                0.11767578,
                -0.2109375,
                -0.14550781,
                0.39648438,
                -0.27734375,
                0.48046875,
                0.12988281,
                0.45507812,
                -0.375,
                -0.84765625,
                0.25585938,
                -0.36523438,
                0.8046875,
                0.42382812,
                -0.24511719,
                0.54296875,
                0.71875,
                0.010009766,
                -0.04296875,
                0.083984375,
                -0.52734375,
                0.13964844,
                -0.27539062,
                -0.30273438,
                1.1484375,
                -0.515625,
                -0.19335938,
                0.58984375,
                0.049072266,
                0.703125,
                -0.04272461,
                0.5078125,
                0.34960938,
                -0.3359375,
                -0.47460938,
                0.049316406,
                0.36523438,
                0.7578125,
                -0.022827148,
                -0.71484375,
                0.21972656,
                0.09716797,
                -0.203125,
                -0.36914062,
                1.34375,
                0.34179688,
                0.46679688,
                1.078125,
                0.26171875,
                0.41992188,
                0.22363281,
                -0.515625,
                -0.5703125,
                0.13378906,
                0.26757812,
                -0.22558594,
                -0.5234375,
                0.06689453,
                0.08251953,
                -0.625,
                0.16796875,
                0.43164062,
                -0.55859375,
                0.28125,
                0.078125,
                0.6328125,
                0.23242188,
                -0.064941406,
                -0.004486084,
                -0.20703125,
                0.2734375,
                0.453125,
                -0.734375,
                0.04272461,
                0.36132812,
                -0.19628906,
                -0.12402344,
                1.3515625,
                0.25585938,
                0.4921875,
                -0.29296875,
                -0.58984375,
                0.021240234,
                -0.044677734,
                0.7578125,
                -0.7890625,
                0.10253906,
                -0.15820312,
                -0.5078125,
                -0.39453125,
                -0.453125,
                0.35742188,
                0.921875,
                0.44335938,
                -0.49804688,
                0.44335938,
                0.31445312,
                0.58984375,
                -1.0078125,
                -0.22460938,
                0.24121094,
                0.87890625,
                0.66015625,
                -0.390625,
                -0.05053711,
                0.059570312,
                0.36132812,
                -0.00038719177,
                -0.017089844,
                0.62890625,
                0.203125,
                0.17480469,
                0.025512695,
                0.47460938,
                0.3125,
                1.140625,
                0.32421875,
                -0.057861328,
                0.36914062,
                -0.7265625,
                -0.51953125,
                0.26953125,
                0.42773438,
                0.064453125,
                0.6328125,
                0.27148438,
                -0.11767578,
                0.66796875,
                -0.38671875,
                0.5234375,
                -0.59375,
                0.5078125,
                0.008239746,
                -0.34179688,
                -0.27539062,
                0.5234375,
                1.296875,
                0.29492188,
                -0.010986328,
                -0.41210938,
                0.59375,
                0.061767578,
                -0.33398438,
                -2.03125,
                0.87890625,
                -0.010620117,
                0.53125,
                0.14257812,
                -0.515625,
                -1.03125,
                0.578125,
                0.1875,
                0.44335938,
                -0.33203125,
                -0.36328125,
                -0.3203125,
                0.29296875,
                -0.8203125,
                0.41015625,
                -0.48242188,
                0.66015625,
                0.5625,
                -0.16503906,
                -0.54296875,
                -0.38085938,
                0.26171875,
                0.62109375,
                0.29101562,
                -0.31054688,
                0.23730469,
                -0.8515625,
                0.5234375,
                0.15332031,
                0.52734375,
                -0.079589844,
                -0.080566406,
                -0.15527344,
                -0.022827148,
                0.030517578,
                -0.1640625,
                -0.421875,
                0.09716797,
                0.03930664,
                -0.055908203,
                -0.546875,
                -0.47851562,
                0.091796875,
                0.32226562,
                -0.94140625,
                -0.04638672,
                -1.203125,
                -0.39648438,
                0.45507812,
                0.296875,
                -0.45703125,
                0.37890625,
                -0.122558594,
                0.28320312,
                -0.01965332,
                -0.11669922,
                -0.34570312,
                -0.53515625,
                -0.091308594,
                -0.9375,
                -0.32617188,
                0.095214844,
                -0.4765625,
                0.37890625,
                -0.859375,
                1.1015625,
                -0.08935547,
                0.46484375,
                -0.19238281,
                0.7109375,
                0.040039062,
                -0.5390625,
                0.22363281,
                -0.70703125,
                0.4921875,
                -0.119140625,
                -0.26757812,
                -0.08496094,
                0.0859375,
                -0.00390625,
                -0.013366699,
                -0.03955078,
                0.07421875,
                -0.13085938,
                0.29101562,
                -0.12109375,
                0.45703125,
                0.021728516,
                0.38671875,
                -0.3671875,
                -0.52734375,
                -0.115722656,
                0.125,
                0.5703125,
                -1.234375,
                0.06298828,
                -0.55859375,
                0.60546875,
                0.8125,
                -0.0032958984,
                -0.068359375,
                -0.21191406,
                0.56640625,
                0.17285156,
                -0.3515625,
                0.36328125,
                -0.99609375,
                0.43554688,
                -0.1015625,
                0.07080078,
                -0.66796875,
                1.359375,
                0.41601562,
                0.15917969,
                0.17773438,
                -0.28710938,
                0.021850586,
                -0.46289062,
                0.17578125,
                -0.03955078,
                -0.026855469,
                0.5078125,
                -0.65625,
                0.0012512207,
                0.044433594,
                -0.18652344,
                0.4921875,
                -0.75390625,
                0.0072021484,
                0.4375,
                -0.31445312,
                0.20214844,
                0.15039062,
                -0.63671875,
                -0.296875,
                -0.375,
                -0.027709961,
                0.013427734,
                0.17089844,
                0.89453125,
                0.11621094,
                -0.43945312,
                -0.30859375,
                0.02709961,
                0.23242188,
                -0.64453125,
                -0.859375,
                0.22167969,
                -0.023071289,
                -0.052734375,
                0.3671875,
                -0.18359375,
                0.81640625,
                -0.11816406,
                0.028320312,
                0.19042969,
                0.012817383,
                -0.43164062,
                0.55859375,
                -0.27929688,
                0.14257812,
                -0.140625,
                -0.048583984,
                -0.014526367,
                0.35742188,
                0.22753906,
                0.13183594,
                0.04638672,
                0.03930664,
                -0.29296875,
                -0.2109375,
                -0.16308594,
                -0.48046875,
                -0.13378906,
                -0.39257812,
                0.29296875,
                -0.047851562,
                -0.5546875,
                0.08300781,
                -0.14941406,
                -0.07080078,
                0.12451172,
                0.1953125,
                -0.51171875,
                -0.048095703,
                0.1953125,
                -0.37695312,
                0.46875,
                -0.084472656,
                0.19042969,
                -0.39453125,
                0.69921875,
                -0.0065307617,
                0.25390625,
                -0.16992188,
                -0.5078125,
                0.016845703,
                0.27929688,
                -0.22070312,
                0.671875,
                0.18652344,
                0.25,
                -0.046875,
                -0.012023926,
                -0.36523438,
                0.36523438,
                -0.11279297,
                0.421875,
                0.079589844,
                -0.100097656,
                0.37304688,
                0.29882812,
                -0.10546875,
                -0.36523438,
                0.040039062,
                0.546875,
                0.12890625,
                -0.06542969,
                -0.38085938,
                -0.35742188,
                -0.6484375,
                -0.28515625,
                0.0107421875,
                -0.055664062,
                0.45703125,
                0.33984375,
                0.26367188,
                -0.23144531,
                0.012878418,
                -0.875,
                0.11035156,
                0.33984375,
                0.203125,
                0.38867188,
                0.24902344,
                -0.37304688,
                -0.98046875,
                -0.122558594,
                -0.17871094,
                -0.09277344,
                0.1796875,
                0.4453125,
                -0.66796875,
                0.78515625,
                0.12988281,
                0.35546875,
                0.44140625,
                0.58984375,
                0.29492188,
                0.7734375,
                -0.21972656,
                -0.40234375,
                -0.22265625,
                0.18359375,
                0.54296875,
                0.17382812,
                0.59375,
                -0.390625,
                -0.92578125,
                -0.017456055,
                -0.25,
                0.73828125,
                0.7578125,
                -0.3828125,
                -0.25976562,
                0.049072266,
                0.046875,
                -0.3515625,
                0.30078125,
                -1.03125,
                -0.48828125,
                0.0017929077,
                -0.26171875,
                0.20214844,
                0.29882812,
                0.064941406,
                0.21484375,
                -0.55078125,
                -0.021362305,
                0.12988281,
                0.27148438,
                0.38867188,
                -0.19726562,
                -0.55078125,
                0.1640625,
                0.32226562,
                -0.72265625,
                0.36132812,
                1.21875,
                -0.22070312,
                -0.32421875,
                -0.29882812,
                0.0024414062,
                0.19921875,
                0.734375,
                0.16210938,
                0.17871094,
                -0.19140625,
                0.38476562,
                -0.06591797,
                -0.47070312,
                -0.040039062,
                -0.33007812,
                -0.07910156,
                -0.2890625,
                0.00970459,
                0.12695312,
                -0.12060547,
                -0.18847656,
                1.015625,
                -0.032958984,
                0.12451172,
                -0.38476562,
                0.063964844,
                1.0859375,
                0.067871094,
                -0.24511719,
                0.125,
                0.10546875,
                -0.22460938,
                -0.29101562,
                0.24414062,
                -0.017944336,
                -0.15625,
                -0.60546875,
                -0.25195312,
                -0.46875,
                0.80859375,
                -0.34960938,
                0.42382812,
                0.796875,
                0.296875,
                -0.067871094,
                0.39453125,
                0.07470703,
                0.033935547,
                0.24414062,
                0.32617188,
                0.023925781,
                0.73046875,
                0.2109375,
                -0.43164062,
                0.14453125,
                0.63671875,
                0.21972656,
                -0.1875,
                -0.18066406,
                -0.22167969,
                -1.3359375,
                0.52734375,
                -0.40625,
                -0.12988281,
                0.17480469,
                -0.18066406,
                0.58984375,
                -0.32421875,
                -0.13476562,
                0.39257812,
                -0.19238281,
                0.068359375,
                0.7265625,
                -0.7109375,
                -0.125,
                0.328125,
                0.34179688,
                -0.48828125,
                -0.10058594,
                -0.83984375,
                0.30273438,
                0.008239746,
                -1.390625,
                0.171875,
                0.34960938,
                0.44921875,
                0.22167969,
                0.60546875,
                -0.36914062,
                -0.028808594,
                -0.19921875,
                0.6875,
                0.52734375,
                -0.07421875,
                0.35546875,
                0.546875,
                0.08691406,
                0.23339844,
                -0.984375,
                -0.20507812,
                0.08544922,
                0.453125,
                -0.07421875,
                -0.953125,
                0.74609375,
                -0.796875,
                0.47851562,
                0.81640625,
                -0.44921875,
                -0.33398438,
                -0.54296875,
                0.46484375,
                -0.390625,
                -0.24121094,
                -0.0115356445,
                1.1328125,
                1.0390625,
                0.6484375,
                0.35742188,
                -0.29492188,
                -0.0007095337,
                -0.060302734,
                0.21777344,
                0.15136719,
                -0.6171875,
                0.11328125,
                -0.025878906,
                0.19238281,
                0.140625,
                0.171875,
                0.25195312,
                0.10546875,
                0.0008354187,
                -0.13476562,
                -0.26953125,
                0.025024414,
                -0.28320312,
                -0.107910156,
                1.015625,
                0.05493164,
                -0.12988281,
                0.30859375,
                0.22558594,
                -0.60546875,
                0.11328125,
                -1.203125,
                0.6484375,
                0.087402344,
                0.32226562,
                0.63671875,
                -0.07714844,
                -1.390625,
                -0.71875,
                -0.34179688,
                -0.10546875,
                -0.37304688,
                -0.09863281,
                -0.41210938,
                -0.14941406,
                0.41210938,
                -0.20898438,
                0.18261719,
                0.67578125,
                0.41601562,
                0.32617188,
                0.2421875,
                -0.14257812,
                -0.6796875,
                0.01953125,
                0.34179688,
                0.20800781,
                -0.123046875,
                0.087402344,
                0.85546875,
                0.33984375,
                0.33203125,
                -0.68359375,
                0.44921875,
                0.50390625,
                0.083496094,
                0.10888672,
                -0.09863281,
                0.55078125,
                0.09765625,
                -0.50390625,
                0.13378906,
                -0.29882812,
                0.030761719,
                -0.64453125,
                0.22949219,
                0.43945312,
                0.16503906,
                0.10888672,
                -0.12792969,
                -0.039794922,
                -0.111328125,
                -0.35742188,
                0.053222656,
                -0.78125,
                -0.4375,
                0.359375,
                -0.88671875,
                -0.21972656,
                -0.053710938,
                0.91796875,
                -0.10644531,
                0.55859375,
                -0.7734375,
                0.5078125,
                0.46484375,
                0.32226562,
                0.16796875,
                -0.28515625,
                0.045410156,
                -0.45117188,
                0.38867188,
                -0.33398438,
                -0.5234375,
                0.296875,
                0.6015625,
                0.3515625,
                -0.734375,
                0.3984375,
                -0.08251953,
                0.359375,
                -0.28515625,
                -0.88671875,
                0.0051879883,
                0.045166016,
                -0.7421875,
                -0.36523438,
                0.140625,
                0.18066406,
                -0.171875,
                -0.15625,
                -0.53515625,
                0.2421875,
                -0.19140625,
                -0.18066406,
                0.25390625,
                0.6875,
                -0.01965332,
                -0.33203125,
                0.29492188,
                0.107421875,
                -0.048339844,
                -0.82421875,
                0.52734375,
                0.78125,
                0.8203125,
                -0.90625,
                0.765625,
                0.0390625,
                0.045410156,
                0.26367188,
                -0.14355469,
                -0.26367188,
                0.390625,
                -0.10888672,
                0.33007812,
                -0.5625,
                0.08105469,
                -0.13769531,
                0.8515625,
                -0.14453125,
                0.77734375,
                -0.48046875,
                -0.3515625,
                -0.25390625,
                -0.09277344,
                0.23925781,
                -0.022338867,
                -0.45898438,
                0.36132812,
                -0.23828125,
                0.265625,
                -0.48632812,
                -0.46875,
                -0.75390625,
                1.3125,
                0.78125,
                -0.63671875,
                -1.21875,
                0.5078125,
                -0.27734375,
                -0.118652344,
                0.041992188,
                -0.14648438,
                -0.8046875,
                0.21679688,
                -0.79296875,
                0.28320312,
                -0.09667969,
                0.42773438,
                0.49414062,
                0.44726562,
                0.21972656,
                -0.02746582,
                -0.03540039,
                -0.14941406,
                -0.515625,
                -0.27929688,
                0.9609375,
                -0.007598877,
                0.34765625,
                -0.060546875,
                -0.44726562,
                0.7421875,
                0.15332031,
                0.45117188,
                -0.4921875,
                0.07080078,
                0.5625,
                0.3984375,
                -0.20019531,
                0.014892578,
                0.63671875,
                -0.0071411133,
                0.016357422,
                1.0625,
                0.049316406,
                0.18066406,
                0.09814453,
                -0.52734375,
                -0.359375,
                -0.072265625,
                -0.41992188,
                0.39648438,
                0.38671875,
                -0.30273438,
                -0.056640625,
                -0.640625,
                -0.44921875,
                0.49414062,
                0.29101562,
                0.49609375,
                0.40429688,
                -0.10205078,
                0.49414062,
                -0.28125,
                -0.12695312,
                -0.0022735596,
                -0.37304688,
                0.122558594,
                0.07519531,
                -0.12597656,
                -0.38085938,
                -0.19824219,
                -0.40039062,
                0.56640625,
                -1.140625,
                -0.515625,
                -0.17578125,
                -0.765625,
                -0.43945312,
                0.3359375,
                -0.24707031,
                0.32617188,
                -0.45117188,
                -0.37109375,
                0.45117188,
                -0.27539062,
                -0.38867188,
                0.09082031,
                0.17675781,
                0.49414062,
                0.19921875,
                0.17480469,
                0.8515625,
                -0.23046875,
                -0.234375,
                -0.28515625,
                0.10253906,
                0.29101562,
                -0.3359375,
                -0.203125,
                0.6484375,
                0.11767578,
                -0.20214844,
                -0.42382812,
                0.26367188,
                0.6328125,
                0.0059509277,
                0.08691406,
                -1.5625,
                -0.43554688,
                0.17675781,
                0.091796875,
                -0.5234375,
                -0.09863281,
                0.20605469,
                0.16601562,
                -0.578125,
                0.017700195,
                0.41015625,
                1.03125,
                -0.55078125,
                0.21289062,
                -0.35351562,
                0.24316406,
                -0.123535156,
                0.11035156,
                -0.48242188,
                -0.34179688,
                0.45117188,
                0.3125,
                -0.071777344,
                0.12792969,
                0.55859375,
                0.063964844,
                -0.21191406,
                0.01965332,
                -1.359375,
                -0.21582031,
                -0.019042969,
                0.16308594,
                -0.3671875,
                -0.40625,
                -1.0234375,
                -0.21289062,
                0.24023438,
                -0.28125,
                0.26953125,
                -0.14550781,
                -0.087890625,
                0.16113281,
                -0.49804688,
                -0.17675781,
                -0.890625,
                0.27929688,
                0.484375,
                0.27148438,
                0.11816406,
                0.83984375,
                0.029052734,
                -0.890625,
                0.66796875,
                0.78515625,
                -0.953125,
                0.49414062,
                -0.546875,
                0.106933594,
                -0.08251953,
                0.2890625,
                -0.1484375,
                -0.85546875,
                0.32421875,
                -0.0040893555,
                -0.16601562,
                -0.16699219,
                0.24414062,
                -0.5078125,
                0.25390625,
                -0.10253906,
                0.15625,
                0.140625,
                -0.27539062,
                -0.546875,
                -0.5546875,
                -0.71875,
                0.37304688,
                0.060058594,
                -0.076171875,
                0.44921875,
                0.06933594,
                -0.28710938,
                -0.22949219,
                0.17578125,
                0.09814453,
                0.4765625,
                -0.95703125,
                -0.03540039,
                0.21289062,
                -0.7578125,
                -0.07373047,
                0.10546875,
                0.07128906,
                0.76171875,
                0.4296875,
                -0.09375,
                0.27539062,
                -0.55078125,
                0.29882812,
                -0.42382812,
                0.32617188,
                -0.39648438,
                0.12451172,
                0.16503906,
                -0.22460938,
                -0.65625,
                -0.022094727,
                0.61328125,
                -0.024780273,
                0.62109375,
                -0.033447266,
                0.515625,
                0.12890625,
                -0.21875,
                -0.08642578,
                0.49804688,
                -0.2265625,
                -0.29296875,
                0.19238281,
                0.3515625,
                -1.265625,
                0.57421875,
                0.20117188,
                -0.28320312,
                0.1953125,
                -0.30664062,
                0.2265625,
                -0.11230469,
                0.83984375,
                0.111328125,
                0.265625,
                0.71484375,
                -0.625,
                0.38867188,
                0.47070312,
                -0.32617188,
                -0.171875,
                1.0078125,
                0.19726562,
                -0.118652344,
                0.63671875,
                -0.068359375,
                -0.25585938,
                0.4140625,
                -0.29296875,
                0.21386719,
                -0.064453125,
                0.15820312,
                -0.89453125,
                -0.16308594,
                0.48046875,
                0.14648438,
                -0.5703125,
                0.84765625,
                -0.19042969,
                0.03515625,
                0.42578125,
                -0.27539062,
                -0.5390625,
                0.95703125,
                0.2734375,
                0.16699219,
                -0.328125,
                0.11279297,
                0.003250122,
                0.47265625,
                -0.31640625,
                0.546875,
                0.55859375,
                0.06933594,
                -0.61328125,
                -0.16210938,
                -0.375,
                0.100097656,
                -0.088378906,
                0.12695312,
                0.079589844,
                0.123535156,
                -1.0078125,
                0.6875,
                0.022949219,
                -0.40039062,
                -0.09863281,
                0.29101562,
                -1.2890625,
                -0.20996094,
                0.36328125,
                -0.3515625,
                0.7890625,
                0.12207031,
                0.48046875,
                -0.13671875,
                -0.041015625,
                0.19824219,
                0.19921875,
                0.01171875,
                -0.37695312,
                -0.62890625,
                0.9375,
                -0.671875,
                0.24609375,
                0.6484375,
                -0.29101562,
                0.076171875,
                0.62109375,
                -0.5546875,
                0.36523438,
                0.75390625,
                -0.19140625,
                -0.875,
                -0.8203125,
                -0.24414062,
                -0.625,
                0.1796875,
                -0.40039062,
                0.25390625,
                -0.14550781,
                -0.21679688,
                -0.828125,
                0.3359375,
                0.43554688,
                0.55078125,
                -0.44921875,
                -0.28710938,
                0.24023438,
                0.18066406,
                -0.6953125,
                0.020385742,
                -0.11376953,
                0.13867188,
                -0.92578125,
                0.33398438,
                -0.328125,
                0.78125,
                -0.45507812,
                -0.07470703,
                0.34179688,
                0.07080078,
                0.76171875,
                0.37890625,
                -0.10644531,
                0.90234375,
                -0.21875,
                -0.15917969,
                -0.36132812,
                0.2109375,
                -0.45703125,
                -0.76953125,
                0.21289062,
                0.26367188,
                0.49804688,
                0.35742188,
                -0.20019531,
                0.31054688,
                0.34179688,
                0.17089844,
                -0.15429688,
                0.39648438,
                -0.5859375,
                0.20996094,
                -0.40039062,
                0.5703125,
                -0.515625,
                0.5234375,
                0.049560547,
                0.328125,
                0.24804688,
                0.42578125,
                0.609375,
                0.19238281,
                0.27929688,
                0.19335938,
                0.78125,
                -0.9921875,
                0.23925781,
                -1.3828125,
                -0.22949219,
                -0.578125,
                -0.13964844,
                -0.17382812,
                -0.011169434,
                0.26171875,
                -0.73046875,
                -1.4375,
                0.6953125,
                -0.7421875,
                0.052246094,
                0.12207031,
                1.3046875,
                0.38867188,
                0.040283203,
                -0.546875,
                -0.0021514893,
                0.18457031,
                -0.5546875,
                -0.51171875,
                -0.16308594,
                -0.104003906,
                -0.38867188,
                -0.20996094,
                -0.8984375,
                0.6015625,
                -0.30078125,
                -0.13769531,
                0.16113281,
                0.58203125,
                -0.23730469,
                -0.125,
                -1.0234375,
                0.875,
                -0.7109375,
                0.29101562,
                0.09667969,
                -0.3203125,
                -0.48046875,
                0.37890625,
                0.734375,
                -0.28710938,
                -0.29882812,
                -0.05493164,
                0.34765625,
                -0.84375,
                0.65625,
                0.578125,
                -0.20019531,
                0.13769531,
                0.10058594,
                -0.37109375,
                0.36523438,
                -0.22167969,
                0.72265625,
            ],
            "inputTextTokenCount": 6,
        },
    ],
    "amazon.titan-embed-text-v1::This is an embedding test.": [
        {"Content-Type": "application/json", "x-amzn-RequestId": "11233989-07e8-4ecb-9ba6-79601ba6d8cc"},
        200,
        {
            "embedding": [
                -0.14160156,
                0.034423828,
                0.54296875,
                0.10986328,
                0.053466797,
                0.3515625,
                0.12988281,
                -0.0002708435,
                -0.21484375,
                0.060302734,
                0.58984375,
                -0.5859375,
                0.52734375,
                0.82421875,
                -0.91015625,
                -0.19628906,
                0.45703125,
                0.609375,
                -0.67578125,
                0.39453125,
                -0.46875,
                -0.25390625,
                -0.21191406,
                0.114746094,
                0.31640625,
                -0.41015625,
                -0.32617188,
                -0.43554688,
                0.4765625,
                -0.4921875,
                0.40429688,
                0.06542969,
                0.859375,
                -0.008056641,
                -0.19921875,
                0.072753906,
                0.33203125,
                0.69921875,
                0.39453125,
                0.15527344,
                0.08886719,
                -0.25,
                0.859375,
                0.22949219,
                -0.19042969,
                0.13769531,
                -0.078125,
                0.41210938,
                0.875,
                0.5234375,
                0.59765625,
                -0.22949219,
                -0.22558594,
                -0.47460938,
                0.37695312,
                0.51953125,
                -0.5703125,
                0.46679688,
                0.43554688,
                0.17480469,
                -0.080566406,
                -0.16699219,
                -0.734375,
                -1.0625,
                -0.33984375,
                0.390625,
                -0.18847656,
                -0.5234375,
                -0.48828125,
                0.44921875,
                -0.09814453,
                -0.3359375,
                0.087402344,
                0.36914062,
                1.3203125,
                0.25585938,
                0.14746094,
                -0.059570312,
                -0.15820312,
                -0.037353516,
                -0.61328125,
                -0.6484375,
                -0.35351562,
                0.55078125,
                -0.26953125,
                0.90234375,
                0.3671875,
                0.31054688,
                0.00014019012,
                -0.171875,
                0.025512695,
                0.5078125,
                0.11621094,
                0.33203125,
                0.8125,
                -0.3046875,
                -1.078125,
                -0.5703125,
                0.26171875,
                -0.4609375,
                0.203125,
                0.44726562,
                -0.5078125,
                0.41601562,
                -0.1953125,
                0.028930664,
                -0.57421875,
                0.2265625,
                0.13574219,
                -0.040039062,
                -0.22949219,
                -0.515625,
                -0.19042969,
                -0.30078125,
                0.10058594,
                -0.66796875,
                0.6015625,
                0.296875,
                -0.765625,
                -0.87109375,
                0.2265625,
                0.068847656,
                -0.088378906,
                -0.1328125,
                -0.796875,
                -0.37304688,
                0.47460938,
                -0.3515625,
                -0.8125,
                -0.32226562,
                0.265625,
                0.3203125,
                -0.4140625,
                -0.49023438,
                0.859375,
                -0.19140625,
                -0.6328125,
                0.10546875,
                -0.5625,
                0.66015625,
                0.26171875,
                -0.2109375,
                0.421875,
                -0.82421875,
                0.29296875,
                0.17773438,
                0.24023438,
                0.5078125,
                -0.49804688,
                -0.10205078,
                0.10498047,
                -0.36132812,
                -0.47460938,
                -0.20996094,
                0.010070801,
                -0.546875,
                0.66796875,
                -0.123046875,
                -0.75390625,
                0.19628906,
                0.17480469,
                0.18261719,
                -0.96875,
                -0.26171875,
                0.4921875,
                -0.40039062,
                0.296875,
                0.1640625,
                -0.20507812,
                -0.36132812,
                0.76171875,
                -1.234375,
                -0.625,
                0.060058594,
                -0.09375,
                -0.14746094,
                1.09375,
                0.057861328,
                0.22460938,
                -0.703125,
                0.07470703,
                0.23828125,
                -0.083984375,
                -0.54296875,
                0.5546875,
                -0.5,
                -0.390625,
                0.106933594,
                0.6640625,
                0.27734375,
                -0.953125,
                0.35351562,
                -0.7734375,
                -0.77734375,
                0.16503906,
                -0.42382812,
                0.36914062,
                0.020141602,
                -1.3515625,
                0.18847656,
                0.13476562,
                -0.034179688,
                -0.03930664,
                -0.03857422,
                -0.027954102,
                0.73828125,
                -0.18945312,
                -0.09814453,
                -0.46289062,
                0.36914062,
                0.033203125,
                0.020874023,
                -0.703125,
                0.91796875,
                0.38671875,
                0.625,
                -0.19335938,
                -0.16796875,
                -0.58203125,
                0.21386719,
                -0.032470703,
                -0.296875,
                -0.15625,
                -0.1640625,
                -0.74609375,
                0.328125,
                0.5546875,
                -0.1953125,
                1.0546875,
                0.171875,
                -0.099609375,
                0.5234375,
                0.05078125,
                -0.35742188,
                -0.2734375,
                -1.3203125,
                -0.8515625,
                -0.16015625,
                0.01574707,
                0.29296875,
                0.18457031,
                -0.265625,
                0.048339844,
                0.045654297,
                -0.32226562,
                0.087890625,
                -0.0047302246,
                0.38671875,
                0.10644531,
                -0.06225586,
                1.03125,
                0.94140625,
                -0.3203125,
                0.20800781,
                -1.171875,
                0.48046875,
                -0.091796875,
                0.20800781,
                -0.1328125,
                -0.20507812,
                0.28125,
                -0.47070312,
                -0.09033203,
                0.0013809204,
                -0.08203125,
                0.43359375,
                -0.03100586,
                -0.060791016,
                -0.53515625,
                -1.46875,
                0.000101566315,
                0.515625,
                0.40625,
                -0.10498047,
                -0.15820312,
                -0.009460449,
                -0.77734375,
                -0.5859375,
                0.9765625,
                0.099609375,
                0.51953125,
                0.38085938,
                -0.09667969,
                -0.100097656,
                -0.5,
                -1.3125,
                -0.18066406,
                -0.099121094,
                0.26171875,
                -0.14453125,
                -0.546875,
                0.17578125,
                0.484375,
                0.765625,
                0.45703125,
                0.2734375,
                0.0028076172,
                0.17089844,
                -0.32421875,
                -0.37695312,
                0.30664062,
                -0.48046875,
                0.07128906,
                0.031982422,
                -0.31054688,
                -0.055419922,
                -0.29296875,
                0.3359375,
                -0.296875,
                0.47851562,
                -0.05126953,
                0.18457031,
                -0.01953125,
                -0.35742188,
                0.017944336,
                -0.25,
                0.10595703,
                0.17382812,
                -0.73828125,
                0.36914062,
                -0.15234375,
                -0.8125,
                0.17382812,
                0.048095703,
                0.5625,
                -0.33789062,
                0.023071289,
                -0.21972656,
                0.16015625,
                0.032958984,
                -1.1171875,
                -0.984375,
                0.83984375,
                0.009033203,
                -0.042236328,
                -0.46484375,
                -0.08203125,
                0.44726562,
                -0.765625,
                -0.3984375,
                -0.40820312,
                -0.234375,
                0.044189453,
                0.119628906,
                -0.7578125,
                -0.55078125,
                -0.4453125,
                0.7578125,
                0.34960938,
                0.96484375,
                0.35742188,
                0.36914062,
                -0.35351562,
                -0.36132812,
                1.109375,
                0.5859375,
                0.85546875,
                -0.10644531,
                -0.6953125,
                -0.0066833496,
                0.042236328,
                -0.06689453,
                0.36914062,
                0.9765625,
                -0.3046875,
                0.59765625,
                -0.6640625,
                0.21484375,
                -0.07128906,
                1.1328125,
                -0.51953125,
                0.86328125,
                -0.11328125,
                0.15722656,
                -0.36328125,
                -0.04638672,
                1.4375,
                0.18457031,
                -0.18359375,
                0.10595703,
                -0.49023438,
                -0.07324219,
                -0.73046875,
                -0.119140625,
                0.021118164,
                0.4921875,
                -0.46875,
                0.28710938,
                0.3359375,
                0.11767578,
                -0.2109375,
                -0.14550781,
                0.39648438,
                -0.27734375,
                0.48046875,
                0.12988281,
                0.45507812,
                -0.375,
                -0.84765625,
                0.25585938,
                -0.36523438,
                0.8046875,
                0.42382812,
                -0.24511719,
                0.54296875,
                0.71875,
                0.010009766,
                -0.04296875,
                0.083984375,
                -0.52734375,
                0.13964844,
                -0.27539062,
                -0.30273438,
                1.1484375,
                -0.515625,
                -0.19335938,
                0.58984375,
                0.049072266,
                0.703125,
                -0.04272461,
                0.5078125,
                0.34960938,
                -0.3359375,
                -0.47460938,
                0.049316406,
                0.36523438,
                0.7578125,
                -0.022827148,
                -0.71484375,
                0.21972656,
                0.09716797,
                -0.203125,
                -0.36914062,
                1.34375,
                0.34179688,
                0.46679688,
                1.078125,
                0.26171875,
                0.41992188,
                0.22363281,
                -0.515625,
                -0.5703125,
                0.13378906,
                0.26757812,
                -0.22558594,
                -0.5234375,
                0.06689453,
                0.08251953,
                -0.625,
                0.16796875,
                0.43164062,
                -0.55859375,
                0.28125,
                0.078125,
                0.6328125,
                0.23242188,
                -0.064941406,
                -0.004486084,
                -0.20703125,
                0.2734375,
                0.453125,
                -0.734375,
                0.04272461,
                0.36132812,
                -0.19628906,
                -0.12402344,
                1.3515625,
                0.25585938,
                0.4921875,
                -0.29296875,
                -0.58984375,
                0.021240234,
                -0.044677734,
                0.7578125,
                -0.7890625,
                0.10253906,
                -0.15820312,
                -0.5078125,
                -0.39453125,
                -0.453125,
                0.35742188,
                0.921875,
                0.44335938,
                -0.49804688,
                0.44335938,
                0.31445312,
                0.58984375,
                -1.0078125,
                -0.22460938,
                0.24121094,
                0.87890625,
                0.66015625,
                -0.390625,
                -0.05053711,
                0.059570312,
                0.36132812,
                -0.00038719177,
                -0.017089844,
                0.62890625,
                0.203125,
                0.17480469,
                0.025512695,
                0.47460938,
                0.3125,
                1.140625,
                0.32421875,
                -0.057861328,
                0.36914062,
                -0.7265625,
                -0.51953125,
                0.26953125,
                0.42773438,
                0.064453125,
                0.6328125,
                0.27148438,
                -0.11767578,
                0.66796875,
                -0.38671875,
                0.5234375,
                -0.59375,
                0.5078125,
                0.008239746,
                -0.34179688,
                -0.27539062,
                0.5234375,
                1.296875,
                0.29492188,
                -0.010986328,
                -0.41210938,
                0.59375,
                0.061767578,
                -0.33398438,
                -2.03125,
                0.87890625,
                -0.010620117,
                0.53125,
                0.14257812,
                -0.515625,
                -1.03125,
                0.578125,
                0.1875,
                0.44335938,
                -0.33203125,
                -0.36328125,
                -0.3203125,
                0.29296875,
                -0.8203125,
                0.41015625,
                -0.48242188,
                0.66015625,
                0.5625,
                -0.16503906,
                -0.54296875,
                -0.38085938,
                0.26171875,
                0.62109375,
                0.29101562,
                -0.31054688,
                0.23730469,
                -0.8515625,
                0.5234375,
                0.15332031,
                0.52734375,
                -0.079589844,
                -0.080566406,
                -0.15527344,
                -0.022827148,
                0.030517578,
                -0.1640625,
                -0.421875,
                0.09716797,
                0.03930664,
                -0.055908203,
                -0.546875,
                -0.47851562,
                0.091796875,
                0.32226562,
                -0.94140625,
                -0.04638672,
                -1.203125,
                -0.39648438,
                0.45507812,
                0.296875,
                -0.45703125,
                0.37890625,
                -0.122558594,
                0.28320312,
                -0.01965332,
                -0.11669922,
                -0.34570312,
                -0.53515625,
                -0.091308594,
                -0.9375,
                -0.32617188,
                0.095214844,
                -0.4765625,
                0.37890625,
                -0.859375,
                1.1015625,
                -0.08935547,
                0.46484375,
                -0.19238281,
                0.7109375,
                0.040039062,
                -0.5390625,
                0.22363281,
                -0.70703125,
                0.4921875,
                -0.119140625,
                -0.26757812,
                -0.08496094,
                0.0859375,
                -0.00390625,
                -0.013366699,
                -0.03955078,
                0.07421875,
                -0.13085938,
                0.29101562,
                -0.12109375,
                0.45703125,
                0.021728516,
                0.38671875,
                -0.3671875,
                -0.52734375,
                -0.115722656,
                0.125,
                0.5703125,
                -1.234375,
                0.06298828,
                -0.55859375,
                0.60546875,
                0.8125,
                -0.0032958984,
                -0.068359375,
                -0.21191406,
                0.56640625,
                0.17285156,
                -0.3515625,
                0.36328125,
                -0.99609375,
                0.43554688,
                -0.1015625,
                0.07080078,
                -0.66796875,
                1.359375,
                0.41601562,
                0.15917969,
                0.17773438,
                -0.28710938,
                0.021850586,
                -0.46289062,
                0.17578125,
                -0.03955078,
                -0.026855469,
                0.5078125,
                -0.65625,
                0.0012512207,
                0.044433594,
                -0.18652344,
                0.4921875,
                -0.75390625,
                0.0072021484,
                0.4375,
                -0.31445312,
                0.20214844,
                0.15039062,
                -0.63671875,
                -0.296875,
                -0.375,
                -0.027709961,
                0.013427734,
                0.17089844,
                0.89453125,
                0.11621094,
                -0.43945312,
                -0.30859375,
                0.02709961,
                0.23242188,
                -0.64453125,
                -0.859375,
                0.22167969,
                -0.023071289,
                -0.052734375,
                0.3671875,
                -0.18359375,
                0.81640625,
                -0.11816406,
                0.028320312,
                0.19042969,
                0.012817383,
                -0.43164062,
                0.55859375,
                -0.27929688,
                0.14257812,
                -0.140625,
                -0.048583984,
                -0.014526367,
                0.35742188,
                0.22753906,
                0.13183594,
                0.04638672,
                0.03930664,
                -0.29296875,
                -0.2109375,
                -0.16308594,
                -0.48046875,
                -0.13378906,
                -0.39257812,
                0.29296875,
                -0.047851562,
                -0.5546875,
                0.08300781,
                -0.14941406,
                -0.07080078,
                0.12451172,
                0.1953125,
                -0.51171875,
                -0.048095703,
                0.1953125,
                -0.37695312,
                0.46875,
                -0.084472656,
                0.19042969,
                -0.39453125,
                0.69921875,
                -0.0065307617,
                0.25390625,
                -0.16992188,
                -0.5078125,
                0.016845703,
                0.27929688,
                -0.22070312,
                0.671875,
                0.18652344,
                0.25,
                -0.046875,
                -0.012023926,
                -0.36523438,
                0.36523438,
                -0.11279297,
                0.421875,
                0.079589844,
                -0.100097656,
                0.37304688,
                0.29882812,
                -0.10546875,
                -0.36523438,
                0.040039062,
                0.546875,
                0.12890625,
                -0.06542969,
                -0.38085938,
                -0.35742188,
                -0.6484375,
                -0.28515625,
                0.0107421875,
                -0.055664062,
                0.45703125,
                0.33984375,
                0.26367188,
                -0.23144531,
                0.012878418,
                -0.875,
                0.11035156,
                0.33984375,
                0.203125,
                0.38867188,
                0.24902344,
                -0.37304688,
                -0.98046875,
                -0.122558594,
                -0.17871094,
                -0.09277344,
                0.1796875,
                0.4453125,
                -0.66796875,
                0.78515625,
                0.12988281,
                0.35546875,
                0.44140625,
                0.58984375,
                0.29492188,
                0.7734375,
                -0.21972656,
                -0.40234375,
                -0.22265625,
                0.18359375,
                0.54296875,
                0.17382812,
                0.59375,
                -0.390625,
                -0.92578125,
                -0.017456055,
                -0.25,
                0.73828125,
                0.7578125,
                -0.3828125,
                -0.25976562,
                0.049072266,
                0.046875,
                -0.3515625,
                0.30078125,
                -1.03125,
                -0.48828125,
                0.0017929077,
                -0.26171875,
                0.20214844,
                0.29882812,
                0.064941406,
                0.21484375,
                -0.55078125,
                -0.021362305,
                0.12988281,
                0.27148438,
                0.38867188,
                -0.19726562,
                -0.55078125,
                0.1640625,
                0.32226562,
                -0.72265625,
                0.36132812,
                1.21875,
                -0.22070312,
                -0.32421875,
                -0.29882812,
                0.0024414062,
                0.19921875,
                0.734375,
                0.16210938,
                0.17871094,
                -0.19140625,
                0.38476562,
                -0.06591797,
                -0.47070312,
                -0.040039062,
                -0.33007812,
                -0.07910156,
                -0.2890625,
                0.00970459,
                0.12695312,
                -0.12060547,
                -0.18847656,
                1.015625,
                -0.032958984,
                0.12451172,
                -0.38476562,
                0.063964844,
                1.0859375,
                0.067871094,
                -0.24511719,
                0.125,
                0.10546875,
                -0.22460938,
                -0.29101562,
                0.24414062,
                -0.017944336,
                -0.15625,
                -0.60546875,
                -0.25195312,
                -0.46875,
                0.80859375,
                -0.34960938,
                0.42382812,
                0.796875,
                0.296875,
                -0.067871094,
                0.39453125,
                0.07470703,
                0.033935547,
                0.24414062,
                0.32617188,
                0.023925781,
                0.73046875,
                0.2109375,
                -0.43164062,
                0.14453125,
                0.63671875,
                0.21972656,
                -0.1875,
                -0.18066406,
                -0.22167969,
                -1.3359375,
                0.52734375,
                -0.40625,
                -0.12988281,
                0.17480469,
                -0.18066406,
                0.58984375,
                -0.32421875,
                -0.13476562,
                0.39257812,
                -0.19238281,
                0.068359375,
                0.7265625,
                -0.7109375,
                -0.125,
                0.328125,
                0.34179688,
                -0.48828125,
                -0.10058594,
                -0.83984375,
                0.30273438,
                0.008239746,
                -1.390625,
                0.171875,
                0.34960938,
                0.44921875,
                0.22167969,
                0.60546875,
                -0.36914062,
                -0.028808594,
                -0.19921875,
                0.6875,
                0.52734375,
                -0.07421875,
                0.35546875,
                0.546875,
                0.08691406,
                0.23339844,
                -0.984375,
                -0.20507812,
                0.08544922,
                0.453125,
                -0.07421875,
                -0.953125,
                0.74609375,
                -0.796875,
                0.47851562,
                0.81640625,
                -0.44921875,
                -0.33398438,
                -0.54296875,
                0.46484375,
                -0.390625,
                -0.24121094,
                -0.0115356445,
                1.1328125,
                1.0390625,
                0.6484375,
                0.35742188,
                -0.29492188,
                -0.0007095337,
                -0.060302734,
                0.21777344,
                0.15136719,
                -0.6171875,
                0.11328125,
                -0.025878906,
                0.19238281,
                0.140625,
                0.171875,
                0.25195312,
                0.10546875,
                0.0008354187,
                -0.13476562,
                -0.26953125,
                0.025024414,
                -0.28320312,
                -0.107910156,
                1.015625,
                0.05493164,
                -0.12988281,
                0.30859375,
                0.22558594,
                -0.60546875,
                0.11328125,
                -1.203125,
                0.6484375,
                0.087402344,
                0.32226562,
                0.63671875,
                -0.07714844,
                -1.390625,
                -0.71875,
                -0.34179688,
                -0.10546875,
                -0.37304688,
                -0.09863281,
                -0.41210938,
                -0.14941406,
                0.41210938,
                -0.20898438,
                0.18261719,
                0.67578125,
                0.41601562,
                0.32617188,
                0.2421875,
                -0.14257812,
                -0.6796875,
                0.01953125,
                0.34179688,
                0.20800781,
                -0.123046875,
                0.087402344,
                0.85546875,
                0.33984375,
                0.33203125,
                -0.68359375,
                0.44921875,
                0.50390625,
                0.083496094,
                0.10888672,
                -0.09863281,
                0.55078125,
                0.09765625,
                -0.50390625,
                0.13378906,
                -0.29882812,
                0.030761719,
                -0.64453125,
                0.22949219,
                0.43945312,
                0.16503906,
                0.10888672,
                -0.12792969,
                -0.039794922,
                -0.111328125,
                -0.35742188,
                0.053222656,
                -0.78125,
                -0.4375,
                0.359375,
                -0.88671875,
                -0.21972656,
                -0.053710938,
                0.91796875,
                -0.10644531,
                0.55859375,
                -0.7734375,
                0.5078125,
                0.46484375,
                0.32226562,
                0.16796875,
                -0.28515625,
                0.045410156,
                -0.45117188,
                0.38867188,
                -0.33398438,
                -0.5234375,
                0.296875,
                0.6015625,
                0.3515625,
                -0.734375,
                0.3984375,
                -0.08251953,
                0.359375,
                -0.28515625,
                -0.88671875,
                0.0051879883,
                0.045166016,
                -0.7421875,
                -0.36523438,
                0.140625,
                0.18066406,
                -0.171875,
                -0.15625,
                -0.53515625,
                0.2421875,
                -0.19140625,
                -0.18066406,
                0.25390625,
                0.6875,
                -0.01965332,
                -0.33203125,
                0.29492188,
                0.107421875,
                -0.048339844,
                -0.82421875,
                0.52734375,
                0.78125,
                0.8203125,
                -0.90625,
                0.765625,
                0.0390625,
                0.045410156,
                0.26367188,
                -0.14355469,
                -0.26367188,
                0.390625,
                -0.10888672,
                0.33007812,
                -0.5625,
                0.08105469,
                -0.13769531,
                0.8515625,
                -0.14453125,
                0.77734375,
                -0.48046875,
                -0.3515625,
                -0.25390625,
                -0.09277344,
                0.23925781,
                -0.022338867,
                -0.45898438,
                0.36132812,
                -0.23828125,
                0.265625,
                -0.48632812,
                -0.46875,
                -0.75390625,
                1.3125,
                0.78125,
                -0.63671875,
                -1.21875,
                0.5078125,
                -0.27734375,
                -0.118652344,
                0.041992188,
                -0.14648438,
                -0.8046875,
                0.21679688,
                -0.79296875,
                0.28320312,
                -0.09667969,
                0.42773438,
                0.49414062,
                0.44726562,
                0.21972656,
                -0.02746582,
                -0.03540039,
                -0.14941406,
                -0.515625,
                -0.27929688,
                0.9609375,
                -0.007598877,
                0.34765625,
                -0.060546875,
                -0.44726562,
                0.7421875,
                0.15332031,
                0.45117188,
                -0.4921875,
                0.07080078,
                0.5625,
                0.3984375,
                -0.20019531,
                0.014892578,
                0.63671875,
                -0.0071411133,
                0.016357422,
                1.0625,
                0.049316406,
                0.18066406,
                0.09814453,
                -0.52734375,
                -0.359375,
                -0.072265625,
                -0.41992188,
                0.39648438,
                0.38671875,
                -0.30273438,
                -0.056640625,
                -0.640625,
                -0.44921875,
                0.49414062,
                0.29101562,
                0.49609375,
                0.40429688,
                -0.10205078,
                0.49414062,
                -0.28125,
                -0.12695312,
                -0.0022735596,
                -0.37304688,
                0.122558594,
                0.07519531,
                -0.12597656,
                -0.38085938,
                -0.19824219,
                -0.40039062,
                0.56640625,
                -1.140625,
                -0.515625,
                -0.17578125,
                -0.765625,
                -0.43945312,
                0.3359375,
                -0.24707031,
                0.32617188,
                -0.45117188,
                -0.37109375,
                0.45117188,
                -0.27539062,
                -0.38867188,
                0.09082031,
                0.17675781,
                0.49414062,
                0.19921875,
                0.17480469,
                0.8515625,
                -0.23046875,
                -0.234375,
                -0.28515625,
                0.10253906,
                0.29101562,
                -0.3359375,
                -0.203125,
                0.6484375,
                0.11767578,
                -0.20214844,
                -0.42382812,
                0.26367188,
                0.6328125,
                0.0059509277,
                0.08691406,
                -1.5625,
                -0.43554688,
                0.17675781,
                0.091796875,
                -0.5234375,
                -0.09863281,
                0.20605469,
                0.16601562,
                -0.578125,
                0.017700195,
                0.41015625,
                1.03125,
                -0.55078125,
                0.21289062,
                -0.35351562,
                0.24316406,
                -0.123535156,
                0.11035156,
                -0.48242188,
                -0.34179688,
                0.45117188,
                0.3125,
                -0.071777344,
                0.12792969,
                0.55859375,
                0.063964844,
                -0.21191406,
                0.01965332,
                -1.359375,
                -0.21582031,
                -0.019042969,
                0.16308594,
                -0.3671875,
                -0.40625,
                -1.0234375,
                -0.21289062,
                0.24023438,
                -0.28125,
                0.26953125,
                -0.14550781,
                -0.087890625,
                0.16113281,
                -0.49804688,
                -0.17675781,
                -0.890625,
                0.27929688,
                0.484375,
                0.27148438,
                0.11816406,
                0.83984375,
                0.029052734,
                -0.890625,
                0.66796875,
                0.78515625,
                -0.953125,
                0.49414062,
                -0.546875,
                0.106933594,
                -0.08251953,
                0.2890625,
                -0.1484375,
                -0.85546875,
                0.32421875,
                -0.0040893555,
                -0.16601562,
                -0.16699219,
                0.24414062,
                -0.5078125,
                0.25390625,
                -0.10253906,
                0.15625,
                0.140625,
                -0.27539062,
                -0.546875,
                -0.5546875,
                -0.71875,
                0.37304688,
                0.060058594,
                -0.076171875,
                0.44921875,
                0.06933594,
                -0.28710938,
                -0.22949219,
                0.17578125,
                0.09814453,
                0.4765625,
                -0.95703125,
                -0.03540039,
                0.21289062,
                -0.7578125,
                -0.07373047,
                0.10546875,
                0.07128906,
                0.76171875,
                0.4296875,
                -0.09375,
                0.27539062,
                -0.55078125,
                0.29882812,
                -0.42382812,
                0.32617188,
                -0.39648438,
                0.12451172,
                0.16503906,
                -0.22460938,
                -0.65625,
                -0.022094727,
                0.61328125,
                -0.024780273,
                0.62109375,
                -0.033447266,
                0.515625,
                0.12890625,
                -0.21875,
                -0.08642578,
                0.49804688,
                -0.2265625,
                -0.29296875,
                0.19238281,
                0.3515625,
                -1.265625,
                0.57421875,
                0.20117188,
                -0.28320312,
                0.1953125,
                -0.30664062,
                0.2265625,
                -0.11230469,
                0.83984375,
                0.111328125,
                0.265625,
                0.71484375,
                -0.625,
                0.38867188,
                0.47070312,
                -0.32617188,
                -0.171875,
                1.0078125,
                0.19726562,
                -0.118652344,
                0.63671875,
                -0.068359375,
                -0.25585938,
                0.4140625,
                -0.29296875,
                0.21386719,
                -0.064453125,
                0.15820312,
                -0.89453125,
                -0.16308594,
                0.48046875,
                0.14648438,
                -0.5703125,
                0.84765625,
                -0.19042969,
                0.03515625,
                0.42578125,
                -0.27539062,
                -0.5390625,
                0.95703125,
                0.2734375,
                0.16699219,
                -0.328125,
                0.11279297,
                0.003250122,
                0.47265625,
                -0.31640625,
                0.546875,
                0.55859375,
                0.06933594,
                -0.61328125,
                -0.16210938,
                -0.375,
                0.100097656,
                -0.088378906,
                0.12695312,
                0.079589844,
                0.123535156,
                -1.0078125,
                0.6875,
                0.022949219,
                -0.40039062,
                -0.09863281,
                0.29101562,
                -1.2890625,
                -0.20996094,
                0.36328125,
                -0.3515625,
                0.7890625,
                0.12207031,
                0.48046875,
                -0.13671875,
                -0.041015625,
                0.19824219,
                0.19921875,
                0.01171875,
                -0.37695312,
                -0.62890625,
                0.9375,
                -0.671875,
                0.24609375,
                0.6484375,
                -0.29101562,
                0.076171875,
                0.62109375,
                -0.5546875,
                0.36523438,
                0.75390625,
                -0.19140625,
                -0.875,
                -0.8203125,
                -0.24414062,
                -0.625,
                0.1796875,
                -0.40039062,
                0.25390625,
                -0.14550781,
                -0.21679688,
                -0.828125,
                0.3359375,
                0.43554688,
                0.55078125,
                -0.44921875,
                -0.28710938,
                0.24023438,
                0.18066406,
                -0.6953125,
                0.020385742,
                -0.11376953,
                0.13867188,
                -0.92578125,
                0.33398438,
                -0.328125,
                0.78125,
                -0.45507812,
                -0.07470703,
                0.34179688,
                0.07080078,
                0.76171875,
                0.37890625,
                -0.10644531,
                0.90234375,
                -0.21875,
                -0.15917969,
                -0.36132812,
                0.2109375,
                -0.45703125,
                -0.76953125,
                0.21289062,
                0.26367188,
                0.49804688,
                0.35742188,
                -0.20019531,
                0.31054688,
                0.34179688,
                0.17089844,
                -0.15429688,
                0.39648438,
                -0.5859375,
                0.20996094,
                -0.40039062,
                0.5703125,
                -0.515625,
                0.5234375,
                0.049560547,
                0.328125,
                0.24804688,
                0.42578125,
                0.609375,
                0.19238281,
                0.27929688,
                0.19335938,
                0.78125,
                -0.9921875,
                0.23925781,
                -1.3828125,
                -0.22949219,
                -0.578125,
                -0.13964844,
                -0.17382812,
                -0.011169434,
                0.26171875,
                -0.73046875,
                -1.4375,
                0.6953125,
                -0.7421875,
                0.052246094,
                0.12207031,
                1.3046875,
                0.38867188,
                0.040283203,
                -0.546875,
                -0.0021514893,
                0.18457031,
                -0.5546875,
                -0.51171875,
                -0.16308594,
                -0.104003906,
                -0.38867188,
                -0.20996094,
                -0.8984375,
                0.6015625,
                -0.30078125,
                -0.13769531,
                0.16113281,
                0.58203125,
                -0.23730469,
                -0.125,
                -1.0234375,
                0.875,
                -0.7109375,
                0.29101562,
                0.09667969,
                -0.3203125,
                -0.48046875,
                0.37890625,
                0.734375,
                -0.28710938,
                -0.29882812,
                -0.05493164,
                0.34765625,
                -0.84375,
                0.65625,
                0.578125,
                -0.20019531,
                0.13769531,
                0.10058594,
                -0.37109375,
                0.36523438,
                -0.22167969,
                0.72265625,
            ],
            "inputTextTokenCount": 6,
        },
    ],
    "amazon.titan-text-express-v1::What is 212 degrees Fahrenheit converted to Celsius?": [
        {"Content-Type": "application/json", "x-amzn-RequestId": "03524118-8d77-430f-9e08-63b5c03a40cf"},
        200,
        {
            "inputTextTokenCount": 12,
            "results": [
                {
                    "tokenCount": 75,
                    "outputText": "\nUse the formula,\n°C = (°F - 32) x 5/9\n= 212 x 5/9\n= 100 degrees Celsius\n212 degrees Fahrenheit is 100 degrees Celsius.",
                    "completionReason": "FINISH",
                }
            ],
        },
    ],
    "anthropic.claude-instant-v1::Human: What is 212 degrees Fahrenheit converted to Celsius? Assistant:": [
        {"Content-Type": "application/json", "x-amzn-RequestId": "7b0b37c6-85fb-4664-8f5b-361ca7b1aa18"},
        200,
        {
            "completion": " Okay, here are the conversion steps:\n212 degrees Fahrenheit\n- Subtract 32 from 212 to get 180 (to convert from Fahrenheit to Celsius scale)\n- Multiply by 5/9 (because the formula is °C = (°F - 32) × 5/9)\n- 180 × 5/9 = 100\n\nSo 212 degrees Fahrenheit converted to Celsius is 100 degrees Celsius.",
            "stop_reason": "stop_sequence",
            "stop": "\n\nHuman:",
        },
    ],
    "cohere.command-text-v14::What is 212 degrees Fahrenheit converted to Celsius?": [
        {"Content-Type": "application/json", "x-amzn-RequestId": "e77422c8-fbbf-4e17-afeb-c758425c9f97"},
        200,
        {
            "generations": [
                {
                    "finish_reason": "MAX_TOKENS",
                    "id": "d20c06b0-aafe-4230-b2c7-200f4069355e",
                    "text": " 212°F is equivalent to 100°C. \n\nFahrenheit and Celsius are two temperature scales commonly used in everyday life. The Fahrenheit scale is based on 32°F for the freezing point of water and 212°F for the boiling point of water. On the other hand, the Celsius scale uses 0°C and 100°C as the freezing and boiling points of water, respectively. \n\nTo convert from Fahrenheit to Celsius, we subtract 32 from the Fahrenheit temperature and multiply the result",
                }
            ],
            "id": "e77422c8-fbbf-4e17-afeb-c758425c9f97",
            "prompt": "What is 212 degrees Fahrenheit converted to Celsius?",
        },
    ],
    "meta.llama2-13b-chat-v1::What is 212 degrees Fahrenheit converted to Celsius?": [
        {"Content-Type": "application/json", "x-amzn-RequestId": "9a64cdb0-3e82-41c7-873a-c12a77e0143a"},
        200,
        {
            "generation": " Here's the answer:\n\n212°F = 100°C\n\nSo, 212 degrees Fahrenheit is equal to 100 degrees Celsius.",
            "prompt_token_count": 17,
            "generation_token_count": 46,
            "stop_reason": "stop",
        },
    ],
    "does-not-exist::": [
        {
            "Content-Type": "application/json",
            "x-amzn-RequestId": "f4908827-3db9-4742-9103-2bbc34578b03",
            "x-amzn-ErrorType": "ValidationException:http://internal.amazon.com/coral/com.amazon.bedrock/",
        },
        400,
        {"message": "The provided model identifier is invalid."},
    ],
    "ai21.j2-mid-v1::Invalid Token": [
        {
            "Content-Type": "application/json",
            "x-amzn-RequestId": "9021791d-3797-493d-9277-e33aa6f6d544",
            "x-amzn-ErrorType": "UnrecognizedClientException:http://internal.amazon.com/coral/com.amazon.coral.service/",
        },
        403,
        {"message": "The security token included in the request is invalid."},
    ],
    "amazon.titan-embed-g1-text-02::Invalid Token": [
        {
            "Content-Type": "application/json",
            "x-amzn-RequestId": "73328313-506e-4da8-af0f-51017fa6ca3f",
            "x-amzn-ErrorType": "UnrecognizedClientException:http://internal.amazon.com/coral/com.amazon.coral.service/",
        },
        403,
        {"message": "The security token included in the request is invalid."},
    ],
    "amazon.titan-embed-text-v1::Invalid Token": [
        {
            "Content-Type": "application/json",
            "x-amzn-RequestId": "aece6ad7-e2ff-443b-a953-ba7d385fd0cc",
            "x-amzn-ErrorType": "UnrecognizedClientException:http://internal.amazon.com/coral/com.amazon.coral.service/",
        },
        403,
        {"message": "The security token included in the request is invalid."},
    ],
    "amazon.titan-text-express-v1::Invalid Token": [
        {
            "Content-Type": "application/json",
            "x-amzn-RequestId": "15b39c8b-8e85-42c9-9623-06720301bda3",
            "x-amzn-ErrorType": "UnrecognizedClientException:http://internal.amazon.com/coral/com.amazon.coral.service/",
        },
        403,
        {"message": "The security token included in the request is invalid."},
    ],
    "anthropic.claude-instant-v1::Human: Invalid Token Assistant:": [
        {
            "Content-Type": "application/json",
            "x-amzn-RequestId": "37396f55-b721-4bae-9461-4c369f5a080d",
            "x-amzn-ErrorType": "UnrecognizedClientException:http://internal.amazon.com/coral/com.amazon.coral.service/",
        },
        403,
        {"message": "The security token included in the request is invalid."},
    ],
    "cohere.command-text-v14::Invalid Token": [
        {
            "Content-Type": "application/json",
            "x-amzn-RequestId": "22476490-a0d6-42db-b5ea-32d0b8a7f751",
            "x-amzn-ErrorType": "UnrecognizedClientException:http://internal.amazon.com/coral/com.amazon.coral.service/",
        },
        403,
        {"message": "The security token included in the request is invalid."},
    ],
    "meta.llama2-13b-chat-v1::Invalid Token": [
        {
            "Content-Type": "application/json",
            "x-amzn-RequestId": "22476490-a0d6-42db-b5ea-32d0b8a7f751",
            "x-amzn-ErrorType": "UnrecognizedClientException:http://internal.amazon.com/coral/com.amazon.coral.service/",
        },
        403,
        {"message": "The security token included in the request is invalid."},
    ],
}

MODEL_PATH_RE = re.compile(r"/model/([^/]+)/invoke")


def simple_get(self):
    content_len = int(self.headers.get("content-length"))
    content = json.loads(self.rfile.read(content_len).decode("utf-8"))

    model = MODEL_PATH_RE.match(self.path).group(1)
    prompt = extract_shortened_prompt(content, model)
    if not prompt:
        self.send_response(500)
        self.end_headers()
        self.wfile.write("Could not parse prompt.".encode("utf-8"))
        return

    headers, response = ({}, "")
    for k, v in RESPONSES.items():
        if prompt.startswith(k):
            headers, status_code, response = v
            break
    else:  # If no matches found
        self.send_response(500)
        self.end_headers()
        self.wfile.write(("Unknown Prompt:\n%s" % prompt).encode("utf-8"))
        return

    # Send response code
    self.send_response(status_code)

    # Send headers
    for k, v in headers.items():
        self.send_header(k, v)
    self.end_headers()

    # Send response body
    self.wfile.write(json.dumps(response).encode("utf-8"))
    return


def extract_shortened_prompt(content, model):
    prompt = content.get("inputText", "") or content.get("prompt", "")
    prompt = "::".join((model, prompt))  # Prepend model name to prompt key to keep separate copies
    return prompt.lstrip().split("\n")[0]


class MockExternalBedrockServer(MockExternalHTTPServer):
    # To use this class in a test one needs to start and stop this server
    # before and after making requests to the test app that makes the external
    # calls.

    def __init__(self, handler=simple_get, port=None, *args, **kwargs):
        super(MockExternalBedrockServer, self).__init__(handler=handler, port=port, *args, **kwargs)


if __name__ == "__main__":
    # Use this to sort dict for easier future incremental updates
    print("RESPONSES = %s" % dict(sorted(RESPONSES.items(), key=lambda i: (i[1][1], i[0]))))

    with MockExternalBedrockServer() as server:
        print("MockExternalBedrockServer serving on port %s" % str(server.port))
        while True:
            pass  # Serve forever
